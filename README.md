# Программа для удаления символов подчеркивания из имен файлов

Эта программа позволяет удалять символы подчеркивания ("_") из имен файлов и упаковывать результаты в ZIP-архив.

## Функции

- Удаление символов подчеркивания из имен файлов (например, "The_Naughty_Gamer_0005" → "TheNaughtyGamer0005")
- Выбор файлов через диалог выбора папки или через перетаскивание (drag and drop)
- Упаковка обработанных файлов в ZIP-архив

## Требования

- Python 3.6+
- tkinter (встроенная библиотека Python, должна быть установлена вместе с Python)
- Библиотеки: customtkinter, pillow, tkinterdnd2

## Установка

Для простой установки всех зависимостей запустите:

```
python install_dependencies.py
```

Этот скрипт проверит наличие tkinter и установит все необходимые библиотеки, включая tkinterdnd2, которая отвечает за функцию перетаскивания файлов.

Если вы предпочитаете установить зависимости вручную:

```
pip install -r requirements.txt
```

Обратите внимание, что библиотека tkinterdnd2 может требовать дополнительных шагов для установки в зависимости от вашей операционной системы.

## Запуск

После установки зависимостей запустите программу одним из следующих способов:

### Полная версия (с поддержкой перетаскивания файлов)
```
python main.py
```
или
```
run.bat
```

### Упрощенная версия (только выбор папки)
Если у вас возникают проблемы с функцией перетаскивания файлов, используйте упрощенную версию:
```
python main_simple.py
```
или
```
run_simple.bat
```

## Использование

1. Выберите файлы одним из способов:
   - Нажмите на область "Перетащите файлы сюда" для выбора папки
   - Перетащите файлы из проводника в программу (только для полной версии)
   - В упрощенной версии просто нажмите кнопку "Выбрать папку"
2. Просмотрите список файлов и их новые имена
3. Нажмите "Обработать файлы" для преобразования
4. После обработки нажмите "Выгрузить ZIP" для сохранения архива с обработанными файлами

## Устранение неполадок

### Отсутствие tkinter

Если вы получаете ошибку, связанную с отсутствием tkinter, выполните следующее:

**Windows:**
1. Переустановите Python, убедившись, что выбрана опция "tcl/tk and IDLE" при установке
2. Или выполните в PowerShell от имени администратора:
   ```
   python -m pip install --force-reinstall --upgrade tk
   ```

**Linux:**
- Ubuntu/Debian: `sudo apt-get install python3-tk`
- Fedora: `sudo dnf install python3-tkinter`
- Arch Linux: `sudo pacman -S tk`

**macOS:**
```
brew install python-tk
```

### Проблемы с tkinterdnd2

Если вы видите ошибку `AttributeError: '_tkinter.tkapp' object has no attribute 'drop_target_register'` или другие проблемы с функцией перетаскивания:

1. Используйте упрощенную версию программы `run_simple.bat` (или `python main_simple.py`)

2. Или попробуйте следующие решения:
   - Переустановите tkinterdnd2 вручную:
     ```
     pip install git+https://github.com/pmgagne/tkinterdnd2.git
     ```
   - Проверьте, что у вас установлена правильная версия Python (tkinterdnd2 может не работать с некоторыми версиями)
   - В Windows может потребоваться установка Microsoft Visual C++ Redistributable 